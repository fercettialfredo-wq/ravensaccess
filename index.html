<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ravens Access</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Estilos personalizados para que coincida con el dise√±o */
        html, body {
            height: 100%;
            overflow-x: hidden;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }
        #app-container {
            min-height: 100vh; /* Asegura que ocupe al menos el 100% de la altura del viewport */
            display: flex;
            flex-direction: column;
        }
        .header-app {
            background-color: #5a1a2e; /* Tono vino/rojo oscuro */
            color: white;
            padding: 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0; /* Evita que el header se encoja */
        }
        .header-logo {
            display: flex;
            align-items: center;
        }
        .header-logo img {
            height: 40px;
            margin-right: 10px;
        }
        .header-logo-text {
            font-weight: bold;
            font-size: 1.25rem;
        }
        .screen {
            display: none; /* Ocultar todas las pantallas por defecto */
            flex-grow: 1; 
            flex-direction: column;
        }
        .screen.active {
            display: flex; /* Mostrar solo la pantalla activa */
        }
        #menu-screen > .main-menu-grid {
             flex-grow: 1; /* Hace que la grilla del men√∫ ocupe todo el espacio sobrante */
        }
        .main-menu-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            padding: 1.5rem;
            background-color: #5a1a2e;
        }
        .menu-item {
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 0.5rem;
            padding: 1rem;
            text-align: center;
            color: white;
            cursor: pointer;
            transition: background-color: 0.3s;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .menu-item:hover {
            background-color: rgba(0, 0, 0, 0.4);
        }
        .menu-item-icon {
            font-size: 3rem;
            margin-bottom: 0.5rem;
        }
        .form-page {
            flex-grow: 1;
        }
        .form-container {
            padding: 1.5rem;
            padding-bottom: 4rem; /* Espacio extra al final */
            overflow-y: auto; /* Permite scroll si el formulario es largo */
        }
        .form-title-section {
            background-color: #5a1a2e;
            color: white;
            padding: 1rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .form-title {
            font-size: 1.5rem;
            font-weight: 300;
        }
        .home-icon {
            cursor: pointer;
        }
        .form-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }
        .btn {
            flex: 1;
            padding: 0.75rem;
            border-radius: 0.375rem;
            font-weight: bold;
            text-align: center;
            cursor: pointer;
        }
        .btn-save {
            background-color: #16a34a;
            color: white;
        }
    </style>
</head>
<body class="bg-gray-100">

    <div id="app-container" class="max-w-md mx-auto bg-white shadow-lg">

        <!-- ============================================= -->
        <!-- PANTALLA DE INICIO DE SESI√ìN (LOGIN)          -->
        <!-- ============================================= -->
        <div id="login-screen" class="screen">
            <header class="header-app">
                <div class="header-logo">
                    <img src="logo.png" alt="Ravens Logo" class="filter brightness-0 invert">
                    <span class="header-logo-text">RAVENS ACCESS</span>
                </div>
            </header>
            <div class="form-container">
                <h2 class="text-2xl font-bold text-center mb-6">Iniciar Sesi√≥n</h2>
                <div class="space-y-4">
                    <div>
                        <label for="username" class="block text-sm font-medium text-gray-700">Usuario</label>
                        <input type="text" id="username" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                    </div>
                    <div>
                        <label for="password" class="block text-sm font-medium text-gray-700">Contrase√±a</label>
                        <input type="password" id="password" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                    </div>
                    <!-- Elemento "Recordarme" a√±adido -->
                    <div class="flex items-center justify-start">
                        <div class="flex items-center">
                            <input id="remember-me" name="remember-me" type="checkbox" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
                            <label for="remember-me" class="ml-2 block text-sm text-gray-900">
                                Recordarme
                            </label>
                        </div>
                    </div>
                    <p id="login-error" class="text-red-500 text-sm text-center hidden">Usuario o contrase√±a incorrectos.</p>
                    <button id="login-button" class="w-full bg-green-600 text-white py-2 px-4 rounded-md font-semibold hover:bg-green-700">
                        Entrar
                    </button>
                </div>
            </div>
        </div>


        <!-- ============================================= -->
        <!-- PANTALLA DEL MEN√ö PRINCIPAL                   -->
        <!-- ============================================= -->
        <div id="menu-screen" class="screen">
            <header class="header-app">
                <div class="header-logo">
                    <img src="logo.png" alt="Ravens Logo" class="filter brightness-0 invert">
                    <span class="header-logo-text">RAVENS ACCESS</span>
                </div>
            </header>
            <div class="main-menu-grid">
                <!-- Residente -->
                <div class="menu-item" onclick="showScreen('residente-form')">
                    <div class="menu-item-icon">üë•</div>
                    <div>Residente</div>
                </div>
                <!-- Visita -->
                <div class="menu-item" onclick="showScreen('visita-form')">
                    <div class="menu-item-icon">ü§ù</div>
                    <div>Visita</div>
                </div>
                <!-- Evento -->
                <div class="menu-item" onclick="showScreen('evento-form')">
                    <div class="menu-item-icon">üìÖ</div>
                    <div>Evento</div>
                </div>
                <!-- Personal de Servicio -->
                <div class="menu-item" onclick="showScreen('servicio-form')">
                    <div class="menu-item-icon">üë∑</div>
                    <div>Personal de servicio</div>
                </div>
                 <!-- Eliminar QR -->
                 <div class="menu-item" onclick="showScreen('qr-form')">
                    <div class="menu-item-icon">üóëÔ∏è</div>
                    <div>Eliminar QR</div>
                </div>
                <!-- Incidencias -->
                <div class="menu-item" onclick="showScreen('incidencias-form')">
                    <div class="menu-item-icon">üì±</div>
                    <div>Incidencias</div>
                </div>
            </div>
        </div>

        <!-- ============================================= -->
        <!-- PANTALLAS DE FORMULARIOS                      -->
        <!-- ============================================= -->
        
        <!-- FORMULARIO: Residente -->
        <div id="residente-form" class="screen form-page" data-form-id="Residente">
            <header class="header-app">
                <div class="header-logo">
                    <img src="logo.png" alt="Ravens Logo" class="filter brightness-0 invert">
                    <span class="header-logo-text">RAVENS ACCESS</span>
                </div>
            </header>
            <div class="form-title-section">
                <h2 class="form-title">Residente</h2>
                <div class="home-icon" onclick="showScreen('menu-screen')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 20 20" fill="currentColor"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" /></svg>
                </div>
            </div>
            <div class="form-container">
                <div class="space-y-4">
                    <div>
                        <label class="block font-bold">Nombre</label>
                        <input type="text" data-field="Nombre" class="mt-1 block w-full px-3 py-2 border border-black rounded-md">
                    </div>
                    <div>
                        <label class="block font-bold">Torre</label>
                        <input type="text" data-field="Torre" class="mt-1 block w-full px-3 py-2 border border-black rounded-md">
                    </div>
                    <div>
                        <label class="block font-bold">Departamento</label>
                        <input type="text" data-field="Departamento" class="mt-1 block w-full px-3 py-2 border border-black rounded-md">
                    </div>
                    <div>
                        <label class="block font-bold">N√∫mero</label>
                        <input type="text" data-field="Numero" class="mt-1 block w-full px-3 py-2 border border-black rounded-md">
                    </div>
                </div>
                <div class="form-buttons">
                    <div class="btn btn-save">Guardar</div>
                </div>
            </div>
        </div>

        <!-- FORMULARIO: Visita -->
        <div id="visita-form" class="screen form-page" data-form-id="Visita">
            <header class="header-app">
                <div class="header-logo">
                    <img src="logo.png" alt="Ravens Logo" class="filter brightness-0 invert">
                    <span class="header-logo-text">RAVENS ACCESS</span>
                </div>
            </header>
            <div class="form-title-section">
                <h2 class="form-title">Visita</h2>
                    <div class="home-icon" onclick="showScreen('menu-screen')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 20 20" fill="currentColor"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" /></svg>
                </div>
            </div>
            <div class="form-container">
                <div class="space-y-4">
                    <div><label class="block font-bold">Nombre</label><input type="text" data-field="Nombre" class="mt-1 block w-full px-3 py-2 border border-black rounded-md"></div>
                    <div><label class="block font-bold">Torre</label><input type="text" data-field="Torre" class="mt-1 block w-full px-3 py-2 border border-black rounded-md"></div>
                    <div><label class="block font-bold">Departamento</label><input type="text" data-field="Departamento" class="mt-1 block w-full px-3 py-2 border border-black rounded-md"></div>
                    <div><label class="block font-bold">N√∫mero</label><input type="text" data-field="Numero" class="mt-1 block w-full px-3 py-2 border border-black rounded-md"></div>
                </div>
                <div class="form-buttons"><div class="btn btn-save">Guardar</div></div>
            </div>
        </div>

        <!-- FORMULARIO: Evento -->
        <div id="evento-form" class="screen form-page" data-form-id="Evento">
            <header class="header-app"><div class="header-logo"><img src="logo.png" alt="Ravens Logo" class="filter brightness-0 invert"><span class="header-logo-text">RAVENS ACCESS</span></div></header>
            <div class="form-title-section"><h2 class="form-title">Evento</h2><div class="home-icon" onclick="showScreen('menu-screen')"><svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 20 20" fill="currentColor"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" /></svg></div></div>
            <div class="form-container">
                <div class="space-y-4">
                    <div><label class="block font-bold">Nombre</label><input type="text" data-field="Nombre" class="mt-1 block w-full px-3 py-2 border border-black rounded-md"></div>
                    <div><label class="block font-bold">Torre</label><input type="text" data-field="Torre" class="mt-1 block w-full px-3 py-2 border border-black rounded-md"></div>
                    <div><label class="block font-bold">Departamento</label><input type="text" data-field="Departamento" class="mt-1 block w-full px-3 py-2 border border-black rounded-md"></div>
                    <div><label class="block font-bold">N√∫mero</label><input type="text" data-field="Numero" class="mt-1 block w-full px-3 py-2 border border-black rounded-md"></div>
                    <div><label class="block font-bold">N QR</label><select data-field="N_QR" class="mt-1 block w-full px-3 py-2 border border-black rounded-md"><option>1</option><option>2</option><option>5</option><option>10</option></select></div>
                </div>
                <div class="form-buttons"><div class="btn btn-save">Guardar</div></div>
            </div>
        </div>

        <!-- FORMULARIO: Personal de servicio -->
        <div id="servicio-form" class="screen form-page" data-form-id="Personal de servicio">
            <header class="header-app"><div class="header-logo"><img src="logo.png" alt="Ravens Logo" class="filter brightness-0 invert"><span class="header-logo-text">RAVENS ACCESS</span></div></header>
            <div class="form-title-section"><h2 class="form-title">Personal del servicio</h2><div class="home-icon" onclick="showScreen('menu-screen')"><svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 20 20" fill="currentColor"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" /></svg></div></div>
            <div class="form-container">
                    <div class="space-y-4">
                    <div><label class="block font-bold">Nombre</label><input type="text" data-field="Nombre" class="mt-1 block w-full px-3 py-2 border border-black rounded-md"></div>
                    <div><label class="block font-bold">Torre</label><input type="text" data-field="Torre" class="mt-1 block w-full px-3 py-2 border border-black rounded-md"></div>
                    <div><label class="block font-bold">Departamento</label><input type="text" data-field="Departamento" class="mt-1 block w-full px-3 py-2 border border-black rounded-md"></div>
                    <div><label class="block font-bold">N√∫mero</label><input type="text" data-field="Numero" class="mt-1 block w-full px-3 py-2 border border-black rounded-md"></div>
                </div>
                <div class="form-buttons"><div class="btn btn-save">Guardar</div></div>
            </div>
        </div>

        <!-- FORMULARIO: Eliminar qr -->
        <div id="qr-form" class="screen form-page" data-form-id="Eliminar QR">
            <header class="header-app"><div class="header-logo"><img src="logo.png" alt="Ravens Logo" class="filter brightness-0 invert"><span class="header-logo-text">RAVENS ACCESS</span></div></header>
            <div class="form-title-section"><h2 class="form-title">Eliminar qr</h2><div class="home-icon" onclick="showScreen('menu-screen')"><svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 20 20" fill="currentColor"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" /></svg></div></div>
            <div class="form-container">
                <div class="space-y-4">
                    <div><label class="block font-bold">Nombre</label><input type="text" data-field="Nombre" class="mt-1 block w-full px-3 py-2 border border-black rounded-md"></div>
                    <div><label class="block font-bold">Torre</label><input type="text" data-field="Torre" class="mt-1 block w-full px-3 py-2 border border-black rounded-md"></div>
                    <div><label class="block font-bold">Departamento</label><input type="text" data-field="Departamento" class="mt-1 block w-full px-3 py-2 border border-black rounded-md"></div>
                    <div><label class="block font-bold">Nombre qr</label><input type="text" data-field="Nombre_QR" class="mt-1 block w-full px-3 py-2 border border-black rounded-md"></div>
                </div>
                <div class="form-buttons"><div class="btn btn-save">Guardar</div></div>
            </div>
        </div>

            <!-- FORMULARIO: Incidencias -->
            <div id="incidencias-form" class="screen form-page" data-form-id="Incidencias">
            <header class="header-app"><div class="header-logo"><img src="logo.png" alt="Ravens Logo" class="filter brightness-0 invert"><span class="header-logo-text">RAVENS ACCESS</span></div></header>
            <div class="form-title-section"><h2 class="form-title">Incidencias</h2><div class="home-icon" onclick="showScreen('menu-screen')"><svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 20 20" fill="currentColor"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" /></svg></div></div>
            <div class="form-container">
                    <div class="space-y-4">
                    <div><label class="block font-bold">Nombre</label><input type="text" data-field="Nombre" class="mt-1 block w-full px-3 py-2 border border-black rounded-md"></div>
                    <div><label class="block font-bold">Torre</label><input type="text" data-field="Torre" class="mt-1 block w-full px-3 py-2 border border-black rounded-md"></div>
                    <div><label class="block font-bold">Departamento</label><input type="text" data-field="Departamento" class="mt-1 block w-full px-3 py-2 border border-black rounded-md"></div>
                    <div><label class="block font-bold">Incidencia</label><input type="text" data-field="Incidencia" class="mt-1 block w-full px-3 py-2 border border-black rounded-md"></div>
                </div>
                <div class="form-buttons"><div class="btn btn-save">Guardar</div></div>
            </div>
        </div>

        <!-- Pop-up de confirmaci√≥n -->
        <div id="confirmation-popup" class="fixed inset-0 bg-black bg-opacity-50 items-center justify-center hidden">
            <div class="bg-white p-6 rounded-lg shadow-xl text-center">
                <h3 class="text-lg font-bold mb-4">¬°Guardado!</h3>
                <p>Los datos han sido enviados correctamente.</p>
                <button id="popup-ok-btn" class="mt-6 bg-green-500 text-white px-4 py-2 rounded-md">OK</button>
            </div>
        </div>

    </div>

    <script>
        // ==================================================================
        // CONFIGURACI√ìN
        // ==================================================================

        // 1. URL DE POWER AUTOMATE:
        // Pega aqu√≠ la URL HTTP POST que te da tu flujo de Power Automate.
        const POWER_AUTOMATE_URL = 'URL_DE_POWER_AUTOMATE_AQUI';

        // 2. CUENTAS Y CONTRASE√ëAS:
        // Agrega aqu√≠ todos los usuarios y contrase√±as que necesites.
        // Formato: "nombre_de_usuario": "contrase√±a"
        const users = {
            "admin": "12345",
            "usuario1": "clave_secreta",
            "demo": "demo",
            "alfredofercetti@gmail.com": "12345"
        };


        // ==================================================================
        // L√ìGICA DE LA APLICACI√ìN (No es necesario editar abajo de esta l√≠nea)
        // ==================================================================
        
        document.addEventListener('DOMContentLoaded', () => {

            const screens = document.querySelectorAll('.screen');
            const usernameInput = document.getElementById('username');
            const passwordInput = document.getElementById('password');
            const rememberMeCheckbox = document.getElementById('remember-me');

            // --- L√≥gica para "Recordarme" ---
            const rememberedUser = localStorage.getItem('rememberedUser');
            const rememberedPass = localStorage.getItem('rememberedPass');
            if (rememberedUser && rememberedPass) {
                usernameInput.value = rememberedUser;
                passwordInput.value = rememberedPass;
                rememberMeCheckbox.checked = true;
            }

            window.showScreen = function(screenId) {
                screens.forEach(screen => {
                    screen.classList.remove('active');
                });
                const activeScreen = document.getElementById(screenId);
                if (activeScreen) {
                    activeScreen.classList.add('active');
                }
            };
            
            // --- L√≥gica de Login ---
            const loginButton = document.getElementById('login-button');
            loginButton.addEventListener('click', () => {
                const username = usernameInput.value;
                const password = passwordInput.value;
                const errorMsg = document.getElementById('login-error');

                if (users[username] && users[username] === password) {
                    // Si la casilla "Recordarme" est√° marcada, guarda usuario y contrase√±a
                    if (rememberMeCheckbox.checked) {
                        localStorage.setItem('rememberedUser', username);
                        localStorage.setItem('rememberedPass', password);
                    } else {
                        // Si no, elimina cualquier dato guardado
                        localStorage.removeItem('rememberedUser');
                        localStorage.removeItem('rememberedPass');
                    }
                    showScreen('menu-screen');
                    errorMsg.classList.add('hidden');
                } else {
                    errorMsg.classList.remove('hidden');
                }
            });

            // --- L√≥gica de Formularios ---
            const saveButtons = document.querySelectorAll('.btn-save');
            saveButtons.forEach(button => {
                button.addEventListener('click', async (event) => {
                    const form = event.target.closest('.form-page');
                    const formId = form.dataset.formId;
                    const inputs = form.querySelectorAll('input, select');
                    
                    const data = {
                        formulario: formId
                    };
                    
                    let allFieldsValid = true;
                    inputs.forEach(input => {
                        data[input.dataset.field] = input.value;
                        if (!input.value) {
                           allFieldsValid = false;
                        }
                    });

                    if (!allFieldsValid) {
                        alert("Por favor, rellena todos los campos.");
                        return;
                    }
                    
                    console.log('Enviando datos:', data);

                    // Simulaci√≥n de env√≠o a Power Automate
                    if (POWER_AUTOMATE_URL === 'URL_DE_POWER_AUTOMATE_AQUI') {
                         console.warn("ADVERTENCIA: La URL de Power Automate no ha sido configurada. Mostrando confirmaci√≥n sin enviar datos.");
                         showConfirmationPopup();
                         return; // No continuar si la URL no est√° configurada
                    }

                    try {
                        const response = await fetch(POWER_AUTOMATE_URL, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(data)
                        });

                        if (response.ok) {
                            showConfirmationPopup();
                            // Limpiar el formulario despu√©s de enviar
                            inputs.forEach(input => {
                                if(input.tagName === 'SELECT') {
                                    input.selectedIndex = 0;
                                } else {
                                    input.value = '';
                                }
                            });
                        } else {
                           alert('Error al enviar los datos. C√≥digo: ' + response.status);
                        }
                    } catch (error) {
                        console.error('Error de red:', error);
                        alert('Error de conexi√≥n. No se pudieron enviar los datos.');
                    }
                });
            });

            // L√≥gica del Pop-up de confirmaci√≥n
            const popup = document.getElementById('confirmation-popup');
            const okBtn = document.getElementById('popup-ok-btn');
            
            function showConfirmationPopup() {
                popup.style.display = 'flex';
            }

            okBtn.addEventListener('click', () => {
                popup.style.display = 'none';
                showScreen('menu-screen');
            });

            // Show the initial screen
             showScreen('login-screen');
        });

    </script>
</body>
</html>

